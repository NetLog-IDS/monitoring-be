<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flow Details | Network IDS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -9px;
            top: 0;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background-color: #0ea5e9;
            border: 3px solid white;
            z-index: 1;
        }
        
        .timeline-item::after {
            content: '';
            position: absolute;
            left: 0;
            top: 18px;
            bottom: 0;
            width: 1px;
            background-color: #e5e7eb;
        }
        
        .timeline-item:last-child::after {
            display: none;
        }
        
        .dark .timeline-item::before {
            border-color: #1f2937;
        }
        
        .dark .timeline-item::after {
            background-color: #374151;
        }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .hexdump {
            font-family: monospace;
            font-size: 0.875rem;
            line-height: 1.25rem;
        }
        
        .hexdump .offset {
            color: #6b7280;
        }
        
        .hexdump .hex {
            color: #1f2937;
        }
        
        .hexdump .ascii {
            color: #4b5563;
        }
        
        .dark .hexdump .hex {
            color: #e5e7eb;
        }
        
        .dark .hexdump .ascii {
            color: #9ca3af;
        }
        
        @keyframes pulse-highlight {
            0%, 100% { background-color: rgba(14, 165, 233, 0.1); }
            50% { background-color: rgba(14, 165, 233, 0.2); }
        }
        
        .pulse-highlight {
            animation: pulse-highlight 2s ease-in-out infinite;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200">
    <!-- Top Navigation Bar -->
    <nav class="bg-white dark:bg-gray-800 shadow-md px-6 py-4 flex justify-between items-center sticky top-0 z-10">
        <div class="flex items-center space-x-3">
            <i class="fas fa-shield-alt text-primary-600 dark:text-primary-400 text-2xl"></i>
            <h1 class="text-xl font-bold text-gray-800 dark:text-white">Network IDS</h1>
        </div>
        <div class="flex items-center space-x-4">
            <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
                <i class="fas fa-moon dark:hidden text-gray-600"></i>
                <i class="fas fa-sun hidden dark:block text-yellow-300"></i>
            </button>
            <button id="export-btn" class="bg-primary-100 dark:bg-primary-900/30 hover:bg-primary-200 dark:hover:bg-primary-800/30 text-primary-700 dark:text-primary-300 px-4 py-2 rounded-lg flex items-center">
                <i class="fas fa-download mr-2"></i>
                <span>Export</span>
            </button>
        </div>
    </nav>

    <!-- Breadcrumb Navigation -->
    <div class="container mx-auto px-4 py-4">
        <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
            <a href="/" class="hover:text-primary-600 dark:hover:text-primary-400">
                <i class="fas fa-home mr-1"></i>
                Dashboard
            </a>
            <i class="fas fa-chevron-right mx-2 text-gray-400 dark:text-gray-600"></i>
            <span class="text-gray-800 dark:text-gray-200 font-medium">Flow Details</span>
            <span class="ml-2 text-gray-500 dark:text-gray-500">({{ flow.fid }})</span>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-4 pb-12">
        <!-- Flow Status Banner -->
        <div class="mb-6 rounded-lg overflow-hidden shadow-md">
            <div class="{% if flow.prediction != 'Benign' %}bg-red-600 dark:bg-red-800{% else %}bg-green-600 dark:bg-green-800{% endif %} px-6 py-4 flex justify-between items-center">
                <div class="flex items-center">
                    <div class="bg-white dark:bg-gray-800 rounded-full p-2 mr-4">
                        <i class="{% if flow.prediction != 'Benign' %}fas fa-exclamation-triangle text-red-600 dark:text-red-500{% else %}fas fa-check-circle text-green-600 dark:text-green-500{% endif %}"></i>
                    </div>
                    <div>
                        <h2 class="text-white font-bold text-lg">{{ flow.prediction }}</h2>
                        <p class="text-white text-opacity-90 text-sm">
                            {% if flow.prediction != 'Benign' %}
                                Potential threat detected in this network flow
                            {% else %}
                                This network flow appears to be normal traffic
                            {% endif %}
                        </p>
                    </div>
                </div>
                <div>
                    {% if flow.prediction != 'Benign' %}
                        <button class="bg-white text-red-600 hover:bg-red-50 px-4 py-2 rounded-lg font-medium">
                            <i class="fas fa-ban mr-2"></i>Block Source
                        </button>
                    {% else %}
                        <button class="bg-white text-green-600 hover:bg-green-50 px-4 py-2 rounded-lg font-medium">
                            <i class="fas fa-check mr-2"></i>Mark as Reviewed
                        </button>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Flow Details and Visualization -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Flow Details Card -->
            <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h2 class="text-lg font-bold text-gray-800 dark:text-white flex items-center">
                        <i class="fas fa-info-circle mr-2 text-primary-500 dark:text-primary-400"></i>
                        Flow Information
                    </h2>
                </div>
                <div class="p-6">
                    <div class="w-full overflow-hidden border border-gray-200 dark:border-gray-700 rounded-lg">
                        <table class="w-full table-auto border-collapse">
                            <tbody>
                                <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <td class="p-3 text-sm font-medium bg-gray-50 dark:bg-gray-700/50 w-1/3">Flow ID</td>
                                    <td class="p-3 text-sm">{{ flow.fid }}</td>
                                </tr>
                                <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <td class="p-3 text-sm font-medium bg-gray-50 dark:bg-gray-700/50">Timestamp</td>
                                    <td class="p-3 text-sm">{{ flow.timestamp }}</td>
                                </tr>
                                <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <td class="p-3 text-sm font-medium bg-gray-50 dark:bg-gray-700/50">Source IP</td>
                                    <td class="p-3 text-sm flex items-center">
                                        {{ flow.srcIp }}
                                        <a href="#" class="ml-2 text-primary-500 hover:text-primary-600 dark:text-primary-400 dark:hover:text-primary-300" title="Lookup IP">
                                            <i class="fas fa-search text-xs"></i>
                                        </a>
                                        <span class="ml-2 px-2 py-0.5 text-xs rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
                                            {% if flow.srcIp == '192.168.1.1' %}
                                                Internal
                                            {% else %}
                                                External
                                            {% endif %}
                                        </span>
                                    </td>
                                </tr>
                                <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <td class="p-3 text-sm font-medium bg-gray-50 dark:bg-gray-700/50">Source Port</td>
                                    <td class="p-3 text-sm">
                                        {{ flow.srcPort }}
                                        <span class="ml-2 px-2 py-0.5 text-xs rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
                                            {% if flow.srcPort < 1024 %}
                                                Well-known
                                            {% elif flow.srcPort < 49152 %}
                                                Registered
                                            {% else %}
                                                Dynamic
                                            {% endif %}
                                        </span>
                                    </td>
                                </tr>
                                <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <td class="p-3 text-sm font-medium bg-gray-50 dark:bg-gray-700/50">Destination IP</td>
                                    <td class="p-3 text-sm flex items-center">
                                        {{ flow.dstIp }}
                                        <a href="#" class="ml-2 text-primary-500 hover:text-primary-600 dark:text-primary-400 dark:hover:text-primary-300" title="Lookup IP">
                                            <i class="fas fa-search text-xs"></i>
                                        </a>
                                        <span class="ml-2 px-2 py-0.5 text-xs rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
                                            {% if flow.dstIp == '192.168.1.1' %}
                                                Internal
                                            {% else %}
                                                External
                                            {% endif %}
                                        </span>
                                    </td>
                                </tr>
                                <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <td class="p-3 text-sm font-medium bg-gray-50 dark:bg-gray-700/50">Destination Port</td>
                                    <td class="p-3 text-sm">
                                        {{ flow.dstPort }}
                                        <span class="ml-2 px-2 py-0.5 text-xs rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
                                            {% if flow.dstPort == 80 %}
                                                HTTP
                                            {% elif flow.dstPort == 443 %}
                                                HTTPS
                                            {% elif flow.dstPort == 22 %}
                                                SSH
                                            {% elif flow.dstPort == 53 %}
                                                DNS
                                            {% elif flow.dstPort < 1024 %}
                                                Well-known
                                            {% elif flow.dstPort < 49152 %}
                                                Registered
                                            {% else %}
                                                Dynamic
                                            {% endif %}
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-3 text-sm font-medium bg-gray-50 dark:bg-gray-700/50">Protocol</td>
                                    <td class="p-3 text-sm">
                                        {% if flow.dstPort == 80 or flow.dstPort == 443 %}
                                            TCP
                                        {% elif flow.dstPort == 53 %}
                                            UDP
                                        {% else %}
                                            TCP/IP
                                        {% endif %}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-6">
                        <h3 class="text-md font-semibold text-gray-800 dark:text-white mb-2">Flow Data</h3>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 overflow-x-auto">
                            <pre class="text-sm text-gray-800 dark:text-gray-200">{{ flow.data }}</pre>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Flow Visualization Card -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h2 class="text-lg font-bold text-gray-800 dark:text-white flex items-center">
                        <i class="fas fa-chart-network mr-2 text-primary-500 dark:text-primary-400"></i>
                        Flow Visualization
                    </h2>
                </div>
                <div class="p-6">
                    <!-- Network Flow Diagram -->
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6">
                        <div class="flex flex-col items-center justify-center h-48">
                            <div class="flex items-center justify-between w-full max-w-xs">
                                <div class="flex flex-col items-center">
                                    <div class="w-16 h-16 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mb-2">
                                        <i class="fas fa-laptop text-blue-600 dark:text-blue-400 text-xl"></i>
                                    </div>
                                    <span class="text-sm font-medium">{{ flow.srcIp }}</span>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">Port {{ flow.srcPort }}</span>
                                </div>
                                
                                <div class="flex-1 px-4 relative">
                                    <div class="h-0.5 bg-primary-500 dark:bg-primary-400 w-full relative">
                                        <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-white dark:bg-gray-700 px-2 text-xs text-gray-500 dark:text-gray-400">
                                            {% if flow.dstPort == 80 %}
                                                HTTP
                                            {% elif flow.dstPort == 443 %}
                                                HTTPS
                                            {% elif flow.dstPort == 22 %}
                                                SSH
                                            {% elif flow.dstPort == 53 %}
                                                DNS
                                            {% else %}
                                                TCP/IP
                                            {% endif %}
                                        </div>
                                        <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 animate-ping">
                                            <i class="fas fa-circle text-primary-500 dark:text-primary-400 text-xs"></i>
                                        </div>
                                    </div>
                                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
                                        <i class="fas fa-exchange-alt text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                                
                                <div class="flex flex-col items-center">
                                    <div class="w-16 h-16 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center mb-2">
                                        <i class="fas fa-server text-purple-600 dark:text-purple-400 text-xl"></i>
                                    </div>
                                    <span class="text-sm font-medium">{{ flow.dstIp }}</span>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">Port {{ flow.dstPort }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Packet Size Distribution -->
                    <h3 class="text-md font-semibold text-gray-800 dark:text-white mb-2">Packet Size Distribution</h3>
                    <div class="bg-white dark:bg-gray-700 rounded-lg p-4 mb-6">
                        <canvas id="packetSizeChart" height="200"></canvas>
                    </div>
                    
                    <!-- Flow Timeline -->
                    <h3 class="text-md font-semibold text-gray-800 dark:text-white mb-2">Flow Timeline</h3>
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 overflow-y-auto max-h-48">
                        <div class="relative pl-6">
                            <div class="timeline-item relative pb-4">
                                <div class="font-medium text-sm">Flow Initiated</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">{{ flow.timestamp }}</div>
                            </div>
                            <div class="timeline-item relative pb-4">
                                <div class="font-medium text-sm">First Packet Sent</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">{{ flow.timestamp }}</div>
                            </div>
                            <div class="timeline-item relative pb-4">
                                <div class="font-medium text-sm">Response Received</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">{{ flow.timestamp }}</div>
                            </div>
                            <div class="timeline-item relative pb-4">
                                <div class="font-medium text-sm">Data Transfer</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">{{ flow.timestamp }}</div>
                            </div>
                            <div class="timeline-item relative">
                                <div class="font-medium text-sm">Flow Completed</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">{{ flow.timestamp }}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Packets Section -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h2 class="text-lg font-bold text-gray-800 dark:text-white flex items-center">
                    <i class="fas fa-exchange-alt mr-2 text-primary-500 dark:text-primary-400"></i>
                    Associated Packets
                </h2>
                <div class="flex space-x-2">
                    <div class="relative">
                        <input type="text" id="packet-search" placeholder="Search packets..." 
                            class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-primary-500 w-64">
                        <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                    </div>
                    <div class="relative">
                        <select id="packet-filter" class="appearance-none bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 py-2 px-4 pr-8 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                            <option value="all">All Packets</option>
                            <option value="tcp">TCP Only</option>
                            <option value="udp">UDP Only</option>
                            <option value="http">HTTP Only</option>
                            <option value="dns">DNS Only</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 dark:text-gray-300">
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Packets Table -->
            <div class="overflow-x-auto">
                <table class="w-full table-auto">
                    <thead class="bg-gray-50 dark:bg-gray-700">
                        <tr>
                            <th class="p-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">UID</th>
                            <th class="p-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Timestamp</th>
                            <th class="p-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Source</th>
                            <th class="p-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Destination</th>
                            <th class="p-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Protocol</th>
                            <th class="p-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Size</th>
                            <th class="p-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="packets-table-body">
                        {% for packet in packets %}
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-150" data-packet-id="{{ packet.uid }}">
                            <td class="p-4 text-sm text-gray-900 dark:text-gray-200">{{ packet.uid }}</td>
                            <td class="p-4 text-sm text-gray-500 dark:text-gray-400">{{ packet.timestamp }}</td>
                            <td class="p-4 text-sm text-gray-500 dark:text-gray-400">{{ packet.srcIp }}:{{ packet.srcPort }}</td>
                            <td class="p-4 text-sm text-gray-500 dark:text-gray-400">{{ packet.dstIp }}:{{ packet.dstPort }}</td>
                            <td class="p-4 text-sm">
                                <span class="px-2 py-1 text-xs font-semibold rounded-full 
                                    {% if 'TCP' in packet.layers %}
                                        bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300
                                    {% elif 'UDP' in packet.layers %}
                                        bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300
                                    {% elif 'ICMP' in packet.layers %}
                                        bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300
                                    {% else %}
                                        bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300
                                    {% endif %}
                                ">
                                    {% if 'TCP' in packet.layers %}
                                        TCP
                                    {% elif 'UDP' in packet.layers %}
                                        UDP
                                    {% elif 'ICMP' in packet.layers %}
                                        ICMP
                                    {% else %}
                                        Other
                                    {% endif %}
                                </span>
                                
                                {% if 'HTTP' in packet.layers %}
                                    <span class="ml-1 px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300">HTTP</span>
                                {% endif %}
                                
                                {% if 'DNS' in packet.layers %}
                                    <span class="ml-1 px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300">DNS</span>
                                {% endif %}
                            </td>
                            <td class="p-4 text-sm text-gray-500 dark:text-gray-400">
                                {{ packet.size|default:"128" }} bytes
                            </td>
                            <td class="p-4 text-sm">
                                <button class="text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 font-medium packet-details-btn">
                                    <i class="fas fa-eye mr-1"></i> View
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <!-- Empty State -->
            <div id="empty-packets" class="flex flex-col items-center justify-center py-12 px-4 {% if packets %}hidden{% endif %}">
                <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-full mb-4">
                    <i class="fas fa-exchange-alt text-4xl text-gray-400 dark:text-gray-500"></i>
                </div>
                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">No packets found</h3>
                <p class="text-gray-500 dark:text-gray-400 text-center mt-2">There are no packets associated with this flow</p>
            </div>
        </div>
    </div>

    <!-- Packet Details Modal -->
    <div id="packet-details-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden">
            <div class="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white">Packet Details</h3>
                <button id="close-modal" class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6 overflow-y-auto" style="max-height: calc(90vh - 120px);">
                <div id="packet-details-content">
                    <!-- Packet Header Information -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Packet Header</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <h5 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Ethernet Frame</h5>
                                <table class="w-full text-sm">
                                    <tbody>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Source MAC:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">00:1A:2B:3C:4D:5E</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Destination MAC:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">00:5E:4D:3C:2B:1A</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Type:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">IPv4 (0x0800)</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <h5 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">IP Header</h5>
                                <table class="w-full text-sm">
                                    <tbody>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Version:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">IPv4</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Header Length:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">20 bytes</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">TTL:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">64</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Protocol:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">TCP (6)</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <h5 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">TCP Header</h5>
                                <table class="w-full text-sm">
                                    <tbody>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Source Port:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">49152</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Destination Port:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">80</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Sequence Number:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">1234567890</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Flags:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">SYN, ACK</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <h5 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Application Layer</h5>
                                <table class="w-full text-sm">
                                    <tbody>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Protocol:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">HTTP</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Method:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">GET</td>
                                        </tr>
                                        <tr>
                                            <td class="py-1 text-gray-500 dark:text-gray-400">Host:</td>
                                            <td class="py-1 text-gray-900 dark:text-gray-200">example.com</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Packet Payload -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Packet Payload</h4>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 overflow-x-auto">
                            <div class="flex mb-2">
                                <button class="px-3 py-1 text-xs font-medium rounded-md bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-300 mr-2">Hex View</button>
                                <button class="px-3 py-1 text-xs font-medium rounded-md bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300 mr-2">ASCII View</button>
                                <button class="px-3 py-1 text-xs font-medium rounded-md bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300">Decoded View</button>
                            </div>
                            <div class="hexdump font-mono whitespace-nowrap">
                                <div><span class="offset">0000</span>: <span class="hex">47 45 54 20 2f 20 48 54 54 50 2f 31 2e 31 0d 0a</span>  <span class="ascii">GET / HTTP/1.1..</span></div>
                                <div><span class="offset">0010</span>: <span class="hex">48 6f 73 74 3a 20 65 78 61 6d 70 6c 65 2e 63 6f</span>  <span class="ascii">Host: example.co</span></div>
                                <div><span class="offset">0020</span>: <span class="hex">6d 0d 0a 55 73 65 72 2d 41 67 65 6e 74 3a 20 4d</span>  <span class="ascii">m..User-Agent: M</span></div>
                                <div><span class="offset">0030</span>: <span class="hex">6f 7a 69 6c 6c 61 2f 35 2e 30 20 28 57 69 6e 64</span>  <span class="ascii">ozilla/5.0 (Wind</span></div>
                                <div><span class="offset">0040</span>: <span class="hex">6f 77 73 20 4e 54 20 31 30 2e 30 3b 20 57 69 6e</span>  <span class="ascii">ows NT 10.0; Win</span></div>
                                <div><span class="offset">0050</span>: <span class="hex">36 34 3b 20 78 36 34 29 20 41 70 70 6c 65 57 65</span>  <span class="ascii">64; x64) AppleWe</span></div>
                                <div class="pulse-highlight"><span class="offset">0060</span>: <span class="hex">62 4b 69 74 2f 35 33 37 2e 33 36 0d 0a 41 63 63</span>  <span class="ascii">bKit/537.36..Acc</span></div>
                                <div><span class="offset">0070</span>: <span class="hex">65 70 74 3a 20 2a 2f 2a 0d 0a 0d 0a</span>  <span class="ascii">ept: */*...</span></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Packet Analysis -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Packet Analysis</h4>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-sm text-gray-700 dark:text-gray-300 mb-3">
                                This packet appears to be a standard HTTP GET request to example.com. The TCP connection is established with SYN, ACK flags set.
                            </p>
                            <div class="flex flex-wrap gap-2 mt-4">
                                <button class="bg-primary-100 hover:bg-primary-200 dark:bg-primary-900/30 dark:hover:bg-primary-800/30 text-primary-700 dark:text-primary-300 px-3 py-1.5 rounded-lg text-sm flex items-center">
                                    <i class="fas fa-file-export mr-2"></i>
                                    <span>Export PCAP</span>
                                </button>
                                <button class="bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 px-3 py-1.5 rounded-lg text-sm flex items-center">
                                    <i class="fas fa-search-plus mr-2"></i>
                                    <span>Deep Inspection</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('theme-toggle');
        
        // Check for saved theme preference or use system preference
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
        
        themeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
        });

        // Packet size chart
        const packetSizeCtx = document.getElementById('packetSizeChart').getContext('2d');
        const packetSizeChart = new Chart(packetSizeCtx, {
            type: 'bar',
            data: {
                labels: ['0-100', '101-200', '201-500', '501-1000', '1001+'],
                datasets: [{
                    label: 'Packet Size (bytes)',
                    data: [4, 7, 3, 2, 1],
                    backgroundColor: [
                        'rgba(14, 165, 233, 0.2)',
                        'rgba(14, 165, 233, 0.4)',
                        'rgba(14, 165, 233, 0.6)',
                        'rgba(14, 165, 233, 0.8)',
                        'rgba(14, 165, 233, 1)'
                    ],
                    borderColor: [
                        'rgba(14, 165, 233, 1)',
                        'rgba(14, 165, 233, 1)',
                        'rgba(14, 165, 233, 1)',
                        'rgba(14, 165, 233, 1)',
                        'rgba(14, 165, 233, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            precision: 0
                        }
                    }
                }
            }
        });

        // Packet details modal
        const packetDetailsModal = document.getElementById('packet-details-modal');
        const closeModalBtn = document.getElementById('close-modal');
        const packetDetailsBtns = document.querySelectorAll('.packet-details-btn');
        
        packetDetailsBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                packetDetailsModal.classList.remove('hidden');
            });
        });
        
        closeModalBtn.addEventListener('click', () => {
            packetDetailsModal.classList.add('hidden');
        });
        
        packetDetailsModal.addEventListener('click', (e) => {
            if (e.target === packetDetailsModal) {
                packetDetailsModal.classList.add('hidden');
            }
        });

        // Packet search functionality
        const packetSearch = document.getElementById('packet-search');
        const packetFilter = document.getElementById('packet-filter');
        const packetRows = document.querySelectorAll('#packets-table-body tr');
        
        packetSearch.addEventListener('input', filterPackets);
        packetFilter.addEventListener('change', filterPackets);
        
        function filterPackets() {
            const searchTerm = packetSearch.value.toLowerCase();
            const filterValue = packetFilter.value;
            
            packetRows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const protocolCell = row.querySelector('td:nth-child(5)');
                const protocol = protocolCell ? protocolCell.textContent.toLowerCase() : '';
                
                const matchesSearch = text.includes(searchTerm);
                let matchesFilter = true;
                
                if (filterValue !== 'all') {
                    matchesFilter = protocol.includes(filterValue);
                }
                
                if (matchesSearch && matchesFilter) {
                    row.classList.remove('hidden');
                } else {
                    row.classList.add('hidden');
                }
            });
            
            // Check if we need to show empty state
            const visibleRows = document.querySelectorAll('#packets-table-body tr:not(.hidden)');
            const emptyState = document.getElementById('empty-packets');
            
            if (visibleRows.length === 0) {
                emptyState.classList.remove('hidden');
            } else {
                emptyState.classList.add('hidden');
            }
        }

        // Export functionality
        document.getElementById('export-btn').addEventListener('click', function() {
            alert('Flow data exported successfully!');
        });
    </script>
</body>
</html>